<!DOCTYPE html>
<html class=" js csstransforms3d"><head>
    <meta charset="utf-8">
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>学员管理</title>
    <link rel="stylesheet" href="/static/css/base.css">
    <link rel="stylesheet" href="/static/css/page.css">
    <!--[if lte IE 8]>
    <link href="/static/css/ie8.css" rel="stylesheet" type="text/css"/>
    <![endif]-->
    <script type="text/javascript" src="/static/js/jquery.min.js"></script>
    <script type="text/javascript" src="/static/js/main.js"></script>
    <script type="text/javascript" src="/static/js/modernizr.js"></script>
    <!--[if IE]>
    <script src="http://libs.useso.com/js/html5shiv/3.7/html5shiv.min.js"></script>
    <![endif]-->
</head>

<body style="background: #f6f5fa;">
<!--content S-->
<div class="super-content RightMain" id="RightMain">

    <div class="super-header clearfix">
        <h2>学员管理</h2>
        <div class="head-right">
            <i class="ico-user"></i>当前用户：
            <div class="userslideDown">
                <a href="javascript:;" class="superUser">Admin<i class="ico-tri"></i></a>
                <div class="slidedownBox">
                    <ul>
                        <li><a href="{:url('/password')}" id="test">修改密码</a></li>
                        <li><a href="{:url('/signout')}">退出</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <!--header-->
    <div class="superCtab">
        <div class="cg-title clearfix">
            <a href="javascript:;" class="default-add-btn newPdBtn"><i class="ico-add"></i>添加学员</a>
            <div class="searchBar">
                <input type="text" id="search" value="" class="form-control srhTxt" placeholder="输入关键字搜索">
                <input type="button" class="srhBtn" onclick="search()" value="">
            </div>
        </div>
        <div class="cgsuperCtab">
            <div class="Mian-cont-wrap">
                <div class="defaultTab-T">
                    <table border="0" cellspacing="0" cellpadding="0" class="defaultTable">
                        <tbody><tr><th class="td_6">学员编号</th><th class="t_1">学员手机号</th><th class="td_8">教练手机号</th><th class="td_10">操作</th></tr>
                        </tbody></table>
                </div>
                <table border="0" cellspacing="0" cellpadding="0" class="defaultTable defaultTable2">
                    <tbody>
                    {volist name="students" id="student"}
                    <tr>
                        <td class="td_6"><span class="label">{$student.idx}</span></td>
                        <td class="t_1">{$student.username}</td>
                        <td class="td_8">{$student.coach_mobile}</td>
                        <td class="td_10"><div class="btn"><a href="javascript:;" class="modify cg-xiugai-a" onclick="selectStudent({$student.id})">修改</a><a href="#" onclick="deleteStudent({$student.id})" class="delete-a">删除</a></div></td>
                    </tr>
                    {/volist}
                    </tbody></table>
                <!--pages S-->
                <div class="pageSelect">
                    <span>共 <b>{$count}</b> 条 每页 <b>10 </b>条   {$page + 1}/{:ceil($count/10)}</span>
                    <div class="pageWrap">
                        <a class="pagePre" href="{:url('/student') . '?page=' . ($page - 1)}"><i class="ico-pre">&nbsp;</i></a>
                        <a href="#" class="pagenumb cur">{$page + 1}</a>
                        <a class="pagenext" href="{:url('/student') . '?page=' . ($page + 1)}"><i class="ico-next">&nbsp;</i></a>
                    </div>
                </div>
                <!--pages E-->
            </div>

        </div>
    </div>
    <!--main-->

</div>
<!--content E-->

<div class="layuiBg"></div><!--公共遮罩-->
<!--点击添加标签弹出-->
<div class="addFeileibox layuiBox newLabelBox">
    <div class="layer-title clearfix"><h2>添加学员</h2><span class="layerClose"></span></div>
    <div class="layer-content">
        <dl class="PDlabel-list clearfix">
            <dt>输入学员手机号：</dt>
            <dd><input id="mobile" type="text" placeholder="11 位数字" class="txt"></dd>
        </dl>
        <dl class="PDlabel-list clearfix">
            <dt>输入学员密码：</dt>
            <dd><input id="password" type="text" placeholder="6 位以上" class="txt"></dd>
        </dl>
        <dl class="PDlabel-list clearfix">
            <dt>输入学员教练手机号：</dt>
            <dd><input id="coach_mobile" type="text" placeholder="11 位数字" class="txt"></dd>
        </dl>
        <dl class="PDlabel-list clearfix">
            <input type="button" value="保存" class="saveBtn addStudentBtn">
        </dl>
    </div>
</div>

<!--点击修改弹出-->
<div class="xcXgBox layuiBox newLabelBox">
    <div class="layer-title clearfix"><h2>修改密码</h2><span class="layerClose"></span></div>
    <div class="layer-content">
        <dl class="PDlabel-list clearfix">
            <dt>新密码：</dt>
            <dd>
                <input id="id" type="hidden" class="txt">
                <input id="newPassword" type="text" class="txt">
            </dd>
        </dl>
        <dl class="PDlabel-list clearfix">
            <input type="button" value="保存" class="saveBtn modifyStudentBtn">
        </dl>
    </div>
</div>

<script>
    $('.addStudentBtn').click(function () {
        $.post("{:url('/addStudent')}", {
                mobile: $('#mobile').val(),
                password: $('#password').val(),
                coach_mobile: $('#coach_mobile').val()
            }, function(data,status) {
                console.log(data);
                if(data != 'ok') {
                    alert(data);
                } else {
                  location.reload();
                }
            });
    });

    function selectStudent(id) {
        $('#id').val(id);
    }

    $('.modifyStudentBtn').click(function () {
        $.post("{:url('/modifyStudent')}", {
            id: $('#id').val(),
            password: $('#newPassword').val()
        }, function(data,status) {
            console.log(data);
            if(data != 'ok') {
                alert(data);
            } else {
                location.reload();
            }
        });
    });

    function deleteStudent(id) {
        var res = confirm('确认删除？');
        if(res) {
            $.post("{:url('/deleteStudent')}", {
                id: id
            }, function(data,status) {
                console.log(data);
                if(data != 'ok') {
                    alert(data);
                } else {
                    location.reload();
                }
            });
        }
    };

    function search() {
        var v = $('#search').val();
        location.href = '{:url("/student")}?page={$page}&search=' + v;
    }

</script>

</body></html>